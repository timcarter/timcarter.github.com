<!DOCTYPE html>
<html manifest="foobar.manifest.DEV" >
	<head>
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>

		<link rel="apple-touch-icon" href="icon.png" />
		<link rel="apple-touch-startup-image" href="icon.png" />
		<link href="../../bootstrap/css/bootstrap.min.css" rel="stylesheet" />
		<link href="../../bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<style type="text/css">
			form>input[type="number"], form>button[type="button"] {
				display:block;
				float:none;
				margin-left:0;
				margin-bottom:10px;
			}
		</style>
	</head>
	<body>
		<div class="container">

			<form>
				<input id="service" type="text" class="span5" placeholder="service" required/>
				<div class="input-append">
					<input id="passphrase" class="span5" type="password" placeholder="passphrase" required/>
					<button class="btn" type="button"><i class="icon-eye-open"></i></button>
				</div>
				<input type="number" class="span5" placeholder="length"/>
				<input type="number" class="span5" placeholder="max repetition"/>
				<button type="button" class="btn span5 btn-info">a-z is: allowed</button>
				<button type="button" class="btn span5 btn-info">A-Z is: allowed</button>
				<button type="button" class="btn span5 btn-info">0-9 is: allowed</button>
				<button type="button" class="btn span5 btn-info">-/_ is: allowed</button>
				<button type="button" class="btn span5 btn-info">SPACE is: allowed</button>
				<button type="button" class="btn span5 btn-info">!@#$% is: allowed</button>
				<hr>
				<div class="input-append">
					<input type="password" class="span5" placeholder="generated passphrase" />
					<button class="btn" type="button"><i class="icon-eye-open"></i></button>
					<button class="btn" type="button"><i class="icon-share"></i></button>
				</div>
			</form>
		</div>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
		<script src="../../bootstrap/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../../vault/crypto-js-3.0.2.js"></script>
		<script type="text/javascript" src="../../vault/vault.js"></script>
		<script type="text/javascript">
			$(document).ready(function () {
				/* application cache handling *
				var
					cache = window.applicationCache,
					updateFn = function () {
						if (cache.status === 4) {
							cache.swapCache ();
							window.location.reload ();
						}
					},
					hasDatabase = 'openDatabase' in window,
					hasLocalStorage = 'localStorage' in window,
					savedConfigs = []
				;

				cache &&
					cache.addEventListener ('updateready', updateFn);

				// open the db, if it exists
				if (hasDatabase) {
					try {
						var db = openDatabase ('vaultdb', '1.0', 'VaultDB', 65536);

						db.transaction (
							function (transaction) {
								transaction.executeSql (
									'select * from configs',
									[],
									function (transaction, results) {
										for (var i = 0; i < results && results.rows ? results.rows.length : 0; ++i)
											savedConfigs.push (results.rows.item (i))
									},
									function (transaction, error) {
										alert (error.message)
									}
								)
							}
						);
					} catch (e) {
						alert ('ERROR: ' + e);
					}
				}*/

				var
					model = {
					// just a simple struct to store our data
					// yes, it can represent a row in our future database too
					},
					tryToGenerate = function () {
						// service is required
						// passphrase is required
						// if length is undefined then any length will do
						// if repetitions is undefined then any repetition is allowed
					}
				;

				$('input[type="text"], input[type="password"]').change (function () {
					var _this = $(this);
					model[_this.attr ('id')] = _this.val();
					tryToGenerate ();
				});

			});
		</script>
	</body>
</html>
