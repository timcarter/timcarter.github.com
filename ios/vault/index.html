<!DOCTYPE html>
<html manifest="foobar.manifest.DEV" >
	<head>
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>

		<link rel="apple-touch-icon" href="icon.png" />
		<link rel="apple-touch-startup-image" href="icon.png" />
		<link href="../../bootstrap/css/bootstrap.min.css" rel="stylesheet" />
		<link href="../../bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<style type="text/css">
			form>input[type="number"], form>button[type="button"] {
				display:block;
				float:none;
				margin-left:0;
				margin-bottom:10px;
			}

			.saved-configs {
				display:none;
			}
		</style>
	</head>
	<body>
		<div class="container">

			<form>
				<input type="text" class="span5" placeholder="service"/>
				<select class="span5 saved-configs"></select>
				<div class="input-append">
					<input class="span5" type="password" placeholder="passphrase"/>
					<button class="btn" type="button"><i class="icon-eye-open"></i></button>
				</div>
				<input type="number" min="1" class="span5" placeholder="length"/>
				<input type="number" min="1" class="span5" placeholder="max repetition"/>
				<button type="button" class="btn span5 btn-info">Allow a-z</button>
				<button type="button" class="btn span5 btn-info">Allow A-Z</button>
				<button type="button" class="btn span5 btn-info">Allow 0-9</button>
				<button type="button" class="btn span5 btn-info">Allow -/_</button>
				<button type="button" class="btn span5 btn-info">Allow SPACE</button>
				<button type="button" class="btn span5 btn-info">Allow !@#$%</button>
				<hr>
				<div class="input-append">
					<input type="password" class="span5" placeholder="generated password" />
					<button class="btn" type="button"><i class="icon-eye-open"></i></button>
					<button class="btn" type="button"><i class="icon-share"></i></button>
				</div>
			</form>
		</div>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
		<script src="../../bootstrap/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../../vault/crypto-js-3.0.2.js"></script>
		<script type="text/javascript" src="../../vault/vault.js"></script>
		<script type="text/javascript">
			$(document).ready(function () {
				var
					// application cache
					cache = window.applicationCache,
					cacheUpdateFn = function () {
						if (cache.status === 4) {
							cache.swapCache ();
							window.location.reload ();
						}
					},

					// saved configurations
					localStorage = window.localStorage,
					savedConfigurations = localStorage ? localStorage.getItem('savedConfigurations') : null,

					// application state
					charMode = {
						REQUIRED:{},
						OPTIONAL:{},
						VERBOTEN:{} // solely for the sake of symmetry
					},
					configuration = { // potentially saved data, pre-loaded with defaults
						service:'twitter',
						length:20,
						repetition:undefined,
						lowerCaseChars:charMode.OPTIONAL,
						upperCaseChars:charMode.OPTIONAL,
						numbers:charMode.OPTIONAL,
						separators:charMode.OPTIONAL,
						whitespace:charMode.OPTIONAL,
						specialChars:charMode.OPTIONAL
					},
					etherealConfig = { // reset every time the application reloads
						showPassPhrase:false,
						showPassword:false
					}
				;

				cache &&
					cache.addEventListener ('updateready', cacheUpdateFn);

				// if there are saved configurations, then show the selector
				if (savedConfigurations) {
					var
						selectNode = $('.saved-configs'),
						optionMarkup = ''
					;

					$.each(
						savedConfigurations,
						function(savedConfiguration) {
							optionMarkup += '<option>' + savedConfiguration.service + '</option>'
						}
					);

					selectNode.append(optionMarkup);
					selectNode.css({display:'block'}); // .show() sets it to inline-block
				}
			});
		</script>
	</body>
</html>
